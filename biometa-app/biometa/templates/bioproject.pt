<div metal:use-macro="load: _layout.pt">

    <div metal:fill-slot="content">
        <div class="content">
            <div>
                <div class="container" name="home_prev_next">
                    <div class="row">
                        <div class="col-md-2">
                            <a href="/" class="btn btn-success" name="homeBtn">Home</a>
                        </div>
                        <div class="col-md-8"></div>
                        <div class="col-md-2">
                            <a href="/prev/${bioproject.get('_id')}" class="btn btn-default">Previous</a>
                            <a href="/next/${bioproject.get('_id')}" class="btn btn-default">Next</a>
                        </div>
                    </div>
                </div>
            </div>

            <h1>BioProject: <a href="https://www.ncbi.nlm.nih.gov/bioproject/?term=${ bioproject.get('_id') }">${
                    bioproject.get("_id") }</a></h1>
            <h2>${ bioproject.get("title") }</h2>
            <p>${ bioproject.get("description") }</p>

            <form action="" method="POST">

                <div class="container">
                    <div class="row biosample" tal:repeat="s bioproject.get('samples')">

                        <div class="col-md-6 sample-desc">
                            <h3><a href="https://www.ncbi.nlm.nih.gov/biosample/?term=${ s.get('biosample') }">${
                                    s.get("biosample") }</a> (${ s.get("accn") })</h3>
                            <span class="attr-name">Title:</span><span class="attr-value">${ s.get('title') }</span>
                            <div class="attributes" tal:repeat="attr s.get('attributes')">
                                <span class="attr-name">${attr.name}: </span>
                                <span class="attr-value">${attr.value}</span>
                            </div>

                        </div>

                        <div class="col-md-6">
                            <input name="${s.get('biosample')}_sex" class="form-control sex" type="text"
                                placeholder="sex" value="${s.get('sex')}">
                            <input name="${s.get('biosample')}_dev" class="form-control dev" type="text"
                                placeholder="developmental stage" value="${s.get('dev_stage')}">
                            <input name="${s.get('biosample')}_tissue" class="form-control tissue" type="text"
                                placeholder="tissue" value="${s.get('tissue')}">
                            <input name="${s.get('biosample')}_cell" class="form-control cell" type="text"
                                placeholder="cell line" value="${s.get('cell_type')}">

                            <label class="checkbox-label" for="${s.get('biosample')}_perturb">
                                <span class="checkbox-text">Perturbed</span>
                                <input id="${s.get('biosample')}_perturb" name="${s.get('biosample')}_perturb"
                                    class="form-control checkbox" type="checkbox"
                                    tal:condition="s.get('perturbed') == 1" tal:attributes="checked True">
                                <input id="${s.get('biosample')}_perturb" name="${s.get('biosample')}_perturb"
                                    class="form-control checkbox" type="checkbox"
                                    tal:condition="not s.get('perturbed') == 1" tal:attributes="checked False">
                            </label>

                            <label class="checkbox-label" for="${s.get('biosample')}_complete">
                                <span class="checkbox-text">Complete</span>
                                <input id="${s.get('biosample')}_complete" name="${s.get('biosample')}_complete"
                                    class="form-control checkbox" type="checkbox" tal:condition="s.get('complete') == 1"
                                    tal:attributes="checked True">
                                <input id="${s.get('biosample')}_complete" name="${s.get('biosample')}_complete"
                                    class="form-control checkbox" type="checkbox"
                                    tal:condition="not s.get('complete') == 1" tal:attributes="checked False">
                            </label>

                        </div>

                    </div>

                    <div class="row">

                        <div class="col-md-10"></div>

                        <div class="col-md-2 actions">
                            <button type="submit" class="btn btn-primary">Save</button>
                        </div>

                    </div>

                </div>

            </form>

            <div class="container" name="propagation">
                <div class="row">
                    <div class="col-md2">
                        <h3>Propagate these values to all samples.</h3>
                    </div>
                </div>
                <div class="row">
                    <div class="col-md-4">
                        <input type="text" name="sex_propagate" placeholder="sex to propagate" class="form-control sex">
                        <input type="text" name="dev_propagate" placeholder="developmental stage to propagate"
                            class="form-control dev">
                    </div>
                    <div class="col-md-4">
                        <input type="text" name="tissue_propagate" placeholder="tissue to propagate"
                            class="form-control tissue">
                        <input type="text" name="cell_propagate" placeholder="cell line to propagate"
                            class="form-control cell">
                    </div>
                </div>
                <div class="row">
                    <input type="button" value="propagateValues" id="propButton" class="btn btn-danger"
                        class="form-control">
                </div>
            </div>

        </div>
    </div>

    <div metal:fill-slot="additional-css">
        <link href="${request.static_url('biometa:static/css/bioproject.css')}" rel="stylesheet">
        <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    </div>
    <div metal:fill-slot="additional-js">
        <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
        <script src="${request.static_url('biometa:static/js/bioproject.js')}"></script>
        <script>
            $(function () {

                var sexVals = ${ structure: sex_values };
                var tissueVals = ${ structure: tissue_values };
                var devVals = ${ structure: dev_values };
                var cellVals = ${ structure: cell_values };

                $(".sex").autocomplete({
                    source: sexVals,
                    delay: 500,
                    minLength: 3
                });

                $(".tissue").autocomplete({
                    source: tissueVals,
                    delay: 500,
                    minLength: 3
                });

                $(".dev").autocomplete({
                    source: devVals,
                    delay: 500,
                    minLength: 3
                });

                $(".cell").autocomplete({
                    source: cellVals,
                    delay: 500,
                    minLength: 3
                });

            });

        </script>
    </div>

</div>